#!/usr/bin/env node
var ref$, reject, each, keys, map, elemIndex, findIndex, join, isType, compact, concat, name, version, fs, download, downloadStatus, mkdirp, msg, tsvToI18nYamls, genI18nYamlsFromUrl, argv, destFolder, slice$ = [].slice;
ref$ = require('prelude-ls'), reject = ref$.reject, each = ref$.each, keys = ref$.keys, map = ref$.map, elemIndex = ref$.elemIndex, findIndex = ref$.findIndex, join = ref$.join, isType = ref$.isType, compact = ref$.compact, concat = ref$.concat;
ref$ = require('../package'), name = ref$.name, version = ref$.version;
fs = require('fs');
download = require('download');
downloadStatus = require('download-status');
mkdirp = require('mkdirp');
msg = function(m){
  return console.log(name + " (" + version + "): " + m);
};
tsvToI18nYamls = function(rawText, destFolder){
  var ref$, header, lines, locales, headerItems;
  ref$ = rawText.toString().split('\r\n'), header = ref$[0], lines = slice$.call(ref$, 1);
  locales = {};
  headerItems = header.split('\t');
  each(function(it){
    if (it !== '' && it !== '#' && it !== 'remark') {
      return locales[it] = elemIndex(it, headerItems);
    }
  })(
  headerItems);
  msg("Generating .yml files ...");
  return each(function(lang){
    var yamlLines, outputFile;
    yamlLines = join('\n')(
    map(function(line){
      var lineItems, keyIndex, indentNKey, value;
      lineItems = line.split('\t');
      keyIndex = findIndex(function(it){
        return it !== '';
      })(
      lineItems);
      if (!isType('Undefined', keyIndex)) {
        indentNKey = repeatString$('  ', keyIndex) + "" + lineItems[keyIndex];
        value = lineItems[locales[lang]];
        return line = (indentNKey + ":") + (value ? " " + value : '');
      }
    })(
    lines));
    outputFile = destFolder + "/" + lang + ".i18n.yml";
    msg("\t -> " + outputFile);
    return fs.writeFileSync(outputFile, yamlLines, {
      flag: 'w'
    });
  })(
  keys(
  locales));
};
genI18nYamlsFromUrl = function(url, destFolder){
  url = url || '';
  destFolder = destFolder || '.';
  return mkdirp(destFolder, function(err){
    if (err) {
      return msg("Error creating destination folder: " + destFolder);
    } else {
      msg("Created destination folder: " + destFolder);
      msg("Getting source TSV file from: " + url);
      return download(url).then(function(data){
        return tsvToI18nYamls(data.toString(), destFolder);
      });
    }
  });
};
argv = require('minimist')(process.argv.slice(2));
destFolder = argv.p || '.';
genI18nYamlsFromUrl(argv.s, destFolder);
function repeatString$(str, n){
  for (var r = ''; n > 0; (n >>= 1) && (str += str)) if (n & 1) r += str;
  return r;
}
//# sourceMappingURL=data:application/json;base64,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QkFBd0IsSUFBSSxDQUFDLEdBQUcsVUFBUiIsInNvdXJjZXNDb250ZW50IjpbImBgIyEvdXNyL2Jpbi9lbnYgbm9kZWBgXG5cbnsgcmVqZWN0LCBlYWNoLCBrZXlzLCBtYXAsIGVsZW0taW5kZXgsIGZpbmQtaW5kZXgsIGpvaW4sIGlzLXR5cGUsIGNvbXBhY3QsIGNvbmNhdCB9ID0gcmVxdWlyZSAncHJlbHVkZS1scydcbnsgbmFtZSwgdmVyc2lvbiB9ID0gcmVxdWlyZSAnLi4vcGFja2FnZSdcbmZzID0gcmVxdWlyZSAnZnMnXG5kb3dubG9hZCA9IHJlcXVpcmUgJ2Rvd25sb2FkJ1xuZG93bmxvYWQtc3RhdHVzID0gcmVxdWlyZSAnZG93bmxvYWQtc3RhdHVzJ1xubWtkaXJwID0gcmVxdWlyZSAnbWtkaXJwJ1xuXG5tc2cgPSAobSkgLT4gY29uc29sZS5sb2cgXCIje25hbWV9ICgje3ZlcnNpb259KTogI3ttfVwiXG5cbnRzdi10by1pMThuLXlhbWxzID0gKHJhdy10ZXh0LCBkZXN0LWZvbGRlcikgLT5cbiAgWyBoZWFkZXIsIC4uLmxpbmVzIF0gPSByYXctdGV4dC50b1N0cmluZyFzcGxpdCAnXFxyXFxuJ1xuICBsb2NhbGVzID0ge30gIyBlLmcuIHsnZW4nOjMsICd6aCc6NH1cbiAgaGVhZGVyLWl0ZW1zID0gaGVhZGVyLnNwbGl0ICdcXHQnXG4gIGhlYWRlci1pdGVtcyB8PiBlYWNoIC0+XG4gICAgaWYgKGl0IG5vdCBpbiBbICcnICcjJyAncmVtYXJrJ10pXG4gICAgICBsb2NhbGVzW2l0XSA9IGVsZW0taW5kZXggaXQsIGhlYWRlci1pdGVtc1xuXG4gIG1zZyBcIkdlbmVyYXRpbmcgLnltbCBmaWxlcyAuLi5cIlxuXG4gIGxvY2FsZXMgfD4ga2V5cyB8PiBlYWNoIChsYW5nKS0+XG4gICAgeWFtbC1saW5lcyA9IGxpbmVzXG4gICAgICAgICAgICAgIHw+IG1hcCAobGluZSktPlxuICAgICAgICAgICAgICAgICAgbGluZS1pdGVtcyA9IGxpbmUuc3BsaXQgJ1xcdCdcbiAgICAgICAgICAgICAgICAgICMgZmluZCAxc3Qgbm9uLWVtcHR5IGNvbHVtbiBvZiB0aGUgbGluZS5cbiAgICAgICAgICAgICAgICAgICMgd2hpY2ggaXMgdGhlIGtleS1pbmRleCBvZiB0aGUgY29ycmVzcG9uZGluZyB5YW1sIGxpbmVcbiAgICAgICAgICAgICAgICAgIGtleS1pbmRleCA9IGxpbmUtaXRlbXMgfD4gZmluZC1pbmRleCAtPiBpdCAhPSAnJ1xuICAgICAgICAgICAgICAgICAgdW5sZXNzIGlzLXR5cGUgJ1VuZGVmaW5lZCcsIGtleS1pbmRleFxuICAgICAgICAgICAgICAgICAgICBpbmRlbnQtbi1rZXkgPSBcIiN7JyAgJyAqIGtleS1pbmRleH0je2xpbmUtaXRlbXNba2V5LWluZGV4XX1cIlxuICAgICAgICAgICAgICAgICAgICAjIHZhbHVlID0gbGluZS1pdGVtc1tsb2NhbGVzW2xhbmddXS5yZXBsYWNlKC9cXFwiL2dpLCdcXFxcXFxcIicpXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbGluZS1pdGVtc1tsb2NhbGVzW2xhbmddXVxuICAgICAgICAgICAgICAgICAgICBsaW5lID0gXCIje2luZGVudC1uLWtleX06XCIgKyAoaWYgdmFsdWUgdGhlbiBcIiAje3ZhbHVlfVwiIGVsc2UgJycpXG4gICAgICAgICAgICAgIHw+IGpvaW4gJ1xcbidcbiAgICBvdXRwdXQtZmlsZSA9IFwiI3tkZXN0LWZvbGRlcn0vI3tsYW5nfS5pMThuLnltbFwiXG4gICAgbXNnIFwiXFx0IC0+ICN7b3V0cHV0LWZpbGV9XCJcbiAgICBmcyAud3JpdGVGaWxlU3luYyBvdXRwdXQtZmlsZSwgeWFtbC1saW5lcywgeyBmbGFnOiAndyd9XG5cbiAgIyBtc2cgXCJHZW5lcmF0aW5nIC5qc29uIGZpbGVzIC4uLlwiXG4gICMgcHJlZml4LWtleXMgPSBbXVxuICAjIGxvY2FsZXMgfD4ga2V5cyB8PiBlYWNoIChsYW5nKS0+XG4gICMgICBqc29uLWxpbmVzID0gbGluZXNcbiAgIyAgICAgICAgICAgICB8PiBtYXAgKGxpbmUpLT5cbiAgIyAgICAgICAgICAgICAgICAganNvbi1saW5lID0gJydcbiAgIyAgICAgICAgICAgICAgICAgbGluZS1pdGVtcyA9IGxpbmUuc3BsaXQgJ1xcdCdcbiAgIyAgICAgICAgICAgICAgICAgIyBmaW5kIDFzdCBub24tZW1wdHkgY29sdW1uIG9mIHRoZSBsaW5lLlxuICAjICAgICAgICAgICAgICAgICAjIHdoaWNoIGlzIHRoZSBrZXktaW5kZXggb2YgdGhlIGNvcnJlc3BvbmRpbmcgeWFtbCBsaW5lXG4gICMgICAgICAgICAgICAgICAgIGtleS1pbmRleCA9IGxpbmUtaXRlbXMgfD4gZmluZC1pbmRleCAtPiBpdCAhPSAnJ1xuICAjICAgICAgICAgICAgICAgICBjb21wYWN0ZWQtaXRlbXMgPSBjb21wYWN0KGxpbmUtaXRlbXMpXG4gICMgICAgICAgICAgICAgICAgIGlmIGtleS1pbmRleCA9PSAwICMgdG9wIGxldmVsIGtleVxuICAjICAgICAgICAgICAgICAgICAgIHByZWZpeC1rZXlzIDo9IFtdICMgcmVzZXQgcHJlZml4LWtleXMgYXJyYXlcbiAgIyAgICAgICAgICAgICAgICAgaWYgY29tcGFjdGVkLWl0ZW1zLmxlbmd0aCA9PSAxICMgbGluZSB3aXRoIG9ubHkgb25lIHByZWZpeC1rZXlcbiAgIyAgICAgICAgICAgICAgICAgICBwcmVmaXgta2V5c1trZXktaW5kZXhdID0gY29tcGFjdGVkLWl0ZW1zWzBdICMgcmVwbGFjZSBwcmVmaXgta2V5c1xuICAjICAgICAgICAgICAgICAgICBpZiBjb21wYWN0ZWQtaXRlbXMubGVuZ3RoID4gMSAjIGxpbmUgY29udGFpbmluZyBib3R0b20gbGV2ZWwga2V5IGFuZCBsYW5nIHZhbHVlXG4gICMgICAgICAgICAgICAgICAgICAgdGhpcy1rZXkgPSBjb21wYWN0ZWQtaXRlbXNbMF1cbiAgIyAgICAgICAgICAgICAgICAgICB0aGlzLXZhbHVlID0gbGluZS1pdGVtc1tsb2NhbGVzW2xhbmddXS5yZXBsYWNlKC9cXFwiL2dpLCdcXFxcXFxcIicpICMgZXNjYXBlIGRvdWJsZSBxdW90ZSAnXCInXG4gICMgICAgICAgICAgICAgICAgICAganNvbi1saW5lIDo9IFwiICBcXFwiI3soIGNvbmNhdCBbIHByZWZpeC1rZXlzLCBbIHRoaXMta2V5IF0gXSB8PiBqb2luICcuJyApfVxcXCIgOiBcXFwiI3t0aGlzLXZhbHVlfVxcXCJcIlxuICAjICAgICAgICAgICAgICAgICByZXR1cm4ganNvbi1saW5lXG4gICMgICAgICAgICAgICAgfD4gcmVqZWN0IC0+IGl0ID09ICcnICMgcmVtb3ZlIGVtcHR5IGxpbmVzXG4gICMgICAgICAgICAgICAgfD4gam9pbiAnLFxcbidcbiAgIyAgIGpzb24tY29udGVudCA9IFwie1xcbiN7anNvbi1saW5lc31cXG59XCJcbiAgIyAgIG91dHB1dC1maWxlID0gXCIje2Rlc3QtZm9sZGVyfS8je2xhbmd9Lmpzb25cIlxuICAjICAgbXNnIFwiXFx0IC0+ICN7b3V0cHV0LWZpbGV9XCJcbiAgIyAgIGZzIC53cml0ZS1maWxlLXN5bmMgb3V0cHV0LWZpbGUsIGpzb24tY29udGVudCwgeyBmbGFnOiAndyd9XG5cbmdlbi1pMThuLXlhbWxzLWZyb20tdXJsID0gKHVybCwgZGVzdC1mb2xkZXIpLT5cbiAgdXJsID0gdXJsIHx8ICcnXG4gIGRlc3QtZm9sZGVyID0gZGVzdC1mb2xkZXIgfHwgJy4nXG4gICMgbWFrZSBzdXJlIGRlc3QtZm9sZGVyIGV4aXN0c1xuICBta2RpcnAgZG9cbiAgICBkZXN0LWZvbGRlclxuICAgIChlcnIpLT5cbiAgICAgIGlmIChlcnIpXG4gICAgICAgIG1zZyBcIkVycm9yIGNyZWF0aW5nIGRlc3RpbmF0aW9uIGZvbGRlcjogI3tkZXN0LWZvbGRlcn1cIlxuICAgICAgZWxzZVxuICAgICAgICBtc2cgXCJDcmVhdGVkIGRlc3RpbmF0aW9uIGZvbGRlcjogI3tkZXN0LWZvbGRlcn1cIlxuICAgICAgICBtc2cgXCJHZXR0aW5nIHNvdXJjZSBUU1YgZmlsZSBmcm9tOiAje3VybH1cIlxuICAgICAgICBkb3dubG9hZCB1cmxcbiAgICAgICAgICAudGhlbiAoZGF0YSktPlxuICAgICAgICAgICAgdHN2LXRvLWkxOG4teWFtbHMoZGF0YS50b1N0cmluZyEsIGRlc3QtZm9sZGVyKVxuXG5hcmd2ID0gcmVxdWlyZSgnbWluaW1pc3QnKShwcm9jZXNzLmFyZ3Yuc2xpY2UoMikpXG4jIG1zZyBKU09OLnN0cmluZ2lmeSBhcmd2XG5kZXN0LWZvbGRlciA9IGFyZ3YucCB8fCAnLidcbmdlbi1pMThuLXlhbWxzLWZyb20tdXJsIGFyZ3YucywgZGVzdC1mb2xkZXJcbiJdfQ==
