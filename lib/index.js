#!/usr/bin/env node
var ref$, reject, each, keys, map, elemIndex, findIndex, join, isType, compact, concat, srcTsv, version, msg, fs, download, downloadStatus, mkdirp, tsvToI18nYamls, genI18nYamlsFromUrl, argv, destFolder, slice$ = [].slice;
ref$ = require('prelude-ls'), reject = ref$.reject, each = ref$.each, keys = ref$.keys, map = ref$.map, elemIndex = ref$.elemIndex, findIndex = ref$.findIndex, join = ref$.join, isType = ref$.isType, compact = ref$.compact, concat = ref$.concat;
if (process.argv.length > 2) {
  srcTsv = process.argv[2];
}
version = '0.3.62';
msg = function(m){
  return console.log("i18n-gen (" + version + "): " + m);
};
fs = require('fs');
download = require('download');
downloadStatus = require('download-status');
mkdirp = require('mkdirp');
tsvToI18nYamls = function(rawText, destFolder){
  var ref$, header, lines, locales, headerItems;
  ref$ = rawText.toString().split('\r\n'), header = ref$[0], lines = slice$.call(ref$, 1);
  locales = {};
  headerItems = header.split('\t');
  each(function(it){
    if (it !== '' && it !== '#' && it !== 'remark') {
      return locales[it] = elemIndex(it, headerItems);
    }
  })(
  headerItems);
  msg("Generating .yml files ...");
  return each(function(lang){
    var yamlLines, outputFile;
    yamlLines = join('\n')(
    map(function(line){
      var lineItems, keyIndex, indentNKey, value;
      lineItems = line.split('\t');
      keyIndex = findIndex(function(it){
        return it !== '';
      })(
      lineItems);
      if (!isType('Undefined', keyIndex)) {
        indentNKey = repeatString$('  ', keyIndex) + "" + lineItems[keyIndex];
        value = lineItems[locales[lang]].replace(/\"/gi, '\\"');
        return line = (indentNKey + ":") + (value ? " \"" + value + "\"" : '');
      }
    })(
    lines));
    outputFile = destFolder + "/" + lang + ".i18n.yml";
    msg("\t -> " + outputFile);
    return fs.writeFileSync(outputFile, yamlLines, {
      flag: 'w'
    });
  })(
  keys(
  locales));
};
genI18nYamlsFromUrl = function(url, destFolder){
  url = url || '';
  destFolder = destFolder || '.';
  return mkdirp(destFolder, function(err){
    if (err) {
      return msg("Error creating destination folder: " + destFolder);
    } else {
      msg("Created destination folder: " + destFolder);
      msg("Getting .tsv from: " + url + ". Target folder: " + destFolder);
      return download(url).then(function(data){
        return tsvToI18nYamls(data.toString(), destFolder);
      });
    }
  });
};
argv = require('minimist')(process.argv.slice(2));
msg(JSON.stringify(argv));
destFolder = argv.p || '.';
genI18nYamlsFromUrl(argv.s, destFolder);
function repeatString$(str, n){
  for (var r = ''; n > 0; (n >>= 1) && (str += str)) if (n & 1) r += str;
  return r;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9pbmRleC5scyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLElBQUEsR0FBc0YsT0FBdEYsQ0FBOEYsWUFBQSxDQUE5RixFQUFFLE1BQWtGLENBQUEsQ0FBQSxDQUFwRixJQUFBLENBQUUsTUFBRixFQUFVLElBQTBFLENBQUEsQ0FBQSxDQUFwRixJQUFBLENBQVUsSUFBVixFQUFnQixJQUFvRSxDQUFBLENBQUEsQ0FBcEYsSUFBQSxDQUFnQixJQUFoQixFQUFzQixHQUE4RCxDQUFBLENBQUEsQ0FBcEYsSUFBQSxDQUFzQixHQUF0QixFQUEyQixTQUF5RCxDQUFBLENBQUEsQ0FBcEYsSUFBQSxDQUEyQixTQUEzQixFQUF1QyxTQUE2QyxDQUFBLENBQUEsQ0FBcEYsSUFBQSxDQUF1QyxTQUF2QyxFQUFtRCxJQUFpQyxDQUFBLENBQUEsQ0FBcEYsSUFBQSxDQUFtRCxJQUFuRCxFQUF5RCxNQUEyQixDQUFBLENBQUEsQ0FBcEYsSUFBQSxDQUF5RCxNQUF6RCxFQUFrRSxPQUFrQixDQUFBLENBQUEsQ0FBcEYsSUFBQSxDQUFrRSxPQUFsRSxFQUEyRSxNQUFTLENBQUEsQ0FBQSxDQUFwRixJQUFBLENBQTJFO0FBQzNFLElBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFPLENBQUEsQ0FBQSxDQUFFLENBQXpCO0VBQ0UsTUFBUSxDQUFBLENBQUEsQ0FBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUQ7O0FBRXhCLE9BQVEsQ0FBQSxDQUFBLENBQUU7QUFDVixHQUFJLENBQUEsQ0FBQSxDQUFFLFFBQUEsQ0FBQSxDQUFBO1NBQU8sT0FBTyxDQUFDLElBQUksWUFBQSxDQUFBLENBQUEsQ0FBYSxPQUFPLENBQUEsQ0FBQSxDQUFDLEtBQUEsQ0FBQSxDQUFBLENBQUssQ0FBOUI7O0FBQ3JCLEVBQUcsQ0FBQSxDQUFBLENBQUUsUUFBUSxJQUFBO0FBQ2IsUUFBUyxDQUFBLENBQUEsQ0FBRSxRQUFRLFVBQUE7QUFDbkIsY0FBZ0IsQ0FBQSxDQUFBLENBQUUsUUFBUSxpQkFBQTtBQUMxQixNQUFPLENBQUEsQ0FBQSxDQUFFLFFBQVEsUUFBQTtBQUVqQixjQUFrQixDQUFBLENBQUEsQ0FBRSxRQUFBLENBQUEsT0FBQSxFQUFBLFVBQUE7O0VBQ2xCLElBQUEsR0FBdUIsT0FBUSxDQUFDLFFBQWhDLENBQXdDLENBQUMsQ0FBQSxLQUF6QyxDQUErQyxNQUFBLENBQS9DLEVBQUUsTUFBbUIsQ0FBQSxDQUFBLENBQXJCLElBQUEsQ0FBQSxDQUFBLENBQUEsRUFBYSxLQUFRLENBQUEsQ0FBQSxDQUFyQjtFQUNBLE9BQVEsQ0FBQSxDQUFBLENBQUU7RUFDVixXQUFhLENBQUEsQ0FBQSxDQUFFLE1BQU0sQ0FBQyxNQUFNLElBQUE7RUFDWixLQUFLLFFBQUEsQ0FBQSxFQUFBO0lBQ25CLElBQUksRUFBQSxLQUFZLEVBQVosSUFBQSxFQUFBLEtBQWUsR0FBZixJQUFBLEVBQUEsS0FBbUIsUUFBdkI7YUFDRSxPQUFPLENBQUMsRUFBRCxDQUFLLENBQUEsQ0FBQSxDQUFFLFVBQVcsSUFBSSxXQUFKOztHQUZSO0VBQXJCO0VBSUEsSUFBK0IsMkJBQUE7U0FFWixLQUFLLFFBQUEsQ0FBQSxJQUFBOztJQUN0QixTQUFXLENBQUEsQ0FBQSxDQVVFLEtBQUssSUFBQTtJQVRMLElBQUksUUFBQSxDQUFBLElBQUE7O01BQ0gsU0FBVyxDQUFBLENBQUEsQ0FBRSxJQUFJLENBQUMsTUFBTSxJQUFBO01BR3hCLFFBQVUsQ0FBQSxDQUFBLENBQWdCLFVBQVcsUUFBQSxDQUFBLEVBQUE7ZUFBRyxFQUFHLENBQUEsR0FBQSxDQUFHO09BQVQ7TUFBekI7TUFDWixJQUFBLENBQU8sTUFBUCxDQUFlLFdBQWYsRUFBNEIsUUFBYixDQUFmO1FBQ0UsVUFBYSxDQUFBLENBQUEsQ0FBVSxhQUFBLENBQUwsSUFBSyxFQUFFLFFBQUYsQ0FBVyxDQUFBLENBQUEsQ0FBQyxFQUFBLENBQUEsQ0FBQSxDQUFFLFNBQVUsQ0FBQyxRQUFEO1FBQy9DLEtBQU0sQ0FBQSxDQUFBLENBQUUsU0FBVSxDQUFDLE9BQU8sQ0FBQyxJQUFELENBQVIsQ0FBZSxDQUFDLFFBQVEsUUFBTyxLQUFSO2VBQ3pDLElBQUssQ0FBQSxDQUFBLENBQUEsQ0FBSyxVQUFZLENBQUEsQ0FBQSxDQUFDLEdBQUUsQ0FBQyxDQUFBLENBQUEsQ0FBQSxDQUFNLEtBQU4sQ0FBWSxFQUFLLEtBQUEsQ0FBQSxDQUFBLENBQU0sS0FBSyxDQUFBLENBQUEsQ0FBQyxJQUE3QixDQUFpQyxFQUFLLEVBQXRDOztLQVJ6QjtJQURKO0lBV2IsVUFBWSxDQUFBLENBQUEsQ0FBSyxVQUFXLENBQUEsQ0FBQSxDQUFDLEdBQUEsQ0FBQSxDQUFBLENBQUcsSUFBSSxDQUFBLENBQUEsQ0FBQztJQUNyQyxJQUFJLFFBQUEsQ0FBQSxDQUFBLENBQVMsVUFBYjtXQUNBLEVBQUcsQ0FBQyxjQUFjLFlBQWEsV0FBWTtNQUFFLE1BQU07SUFBUixDQUF6QjtHQWRJO0VBQWI7RUFBWDs7QUEyQ0YsbUJBQXdCLENBQUEsQ0FBQSxDQUFFLFFBQUEsQ0FBQSxHQUFBLEVBQUEsVUFBQTtFQUN4QixHQUFJLENBQUEsQ0FBQSxDQUFFLEdBQUksQ0FBQSxFQUFBLENBQUc7RUFDYixVQUFZLENBQUEsQ0FBQSxDQUFFLFVBQVksQ0FBQSxFQUFBLENBQUc7U0FFN0IsT0FDRSxZQUNBLFFBQUEsQ0FBQSxHQUFBO0lBQ0UsSUFBSSxHQUFKO2FBQ0UsSUFBSSxxQ0FBQSxDQUFBLENBQUEsQ0FBc0MsVUFBMUM7S0FDRjtNQUNFLElBQUksOEJBQUEsQ0FBQSxDQUFBLENBQStCLFVBQW5DO01BQ0EsSUFBSSxxQkFBQSxDQUFBLENBQUEsQ0FBc0IsR0FBRyxDQUFBLENBQUEsQ0FBQyxtQkFBQSxDQUFBLENBQUEsQ0FBbUIsVUFBakQ7YUFDQSxTQUFTLEdBQUEsQ0FDUCxDQUFDLEtBQUssUUFBQSxDQUFBLElBQUE7ZUFDSixlQUFrQixJQUFJLENBQUMsU0FBUSxHQUFHLFVBQWpCO09BRGI7O0dBUlo7O0FBV0osSUFBSyxDQUFBLENBQUEsQ0FBRSxRQUFRLFVBQUQsRUFBYSxPQUFPLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBRCxDQUFuQjtBQUMxQixJQUFJLElBQUksQ0FBQyxVQUFVLElBQUEsQ0FBZjtBQUNKLFVBQVksQ0FBQSxDQUFBLENBQUUsSUFBSSxDQUFDLENBQUUsQ0FBQSxFQUFBLENBQUc7QUFDeEIsb0JBQXdCLElBQUksQ0FBQyxHQUFHLFVBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJgYCMhL3Vzci9iaW4vZW52IG5vZGVgYFxuXG57IHJlamVjdCwgZWFjaCwga2V5cywgbWFwLCBlbGVtLWluZGV4LCBmaW5kLWluZGV4LCBqb2luLCBpcy10eXBlLCBjb21wYWN0LCBjb25jYXQgfSA9IHJlcXVpcmUgJ3ByZWx1ZGUtbHMnXG5pZiBwcm9jZXNzLmFyZ3YubGVuZ3RoID4gMlxuICBzcmMtdHN2ID0gcHJvY2Vzcy5hcmd2LjJcblxudmVyc2lvbiA9ICcwLjMuNjInXG5tc2cgPSAobSkgLT4gY29uc29sZS5sb2cgXCJpMThuLWdlbiAoI3t2ZXJzaW9ufSk6ICN7bX1cIlxuZnMgPSByZXF1aXJlICdmcydcbmRvd25sb2FkID0gcmVxdWlyZSAnZG93bmxvYWQnXG5kb3dubG9hZC1zdGF0dXMgPSByZXF1aXJlICdkb3dubG9hZC1zdGF0dXMnXG5ta2RpcnAgPSByZXF1aXJlICdta2RpcnAnXG5cbnRzdi10by1pMThuLXlhbWxzID0gKHJhdy10ZXh0LCBkZXN0LWZvbGRlcikgLT5cbiAgWyBoZWFkZXIsIC4uLmxpbmVzIF0gPSByYXctdGV4dC50b1N0cmluZyFzcGxpdCAnXFxyXFxuJ1xuICBsb2NhbGVzID0ge30gIyBlLmcuIHsnZW4nOjMsICd6aCc6NH1cbiAgaGVhZGVyLWl0ZW1zID0gaGVhZGVyLnNwbGl0ICdcXHQnXG4gIGhlYWRlci1pdGVtcyB8PiBlYWNoIC0+XG4gICAgaWYgKGl0IG5vdCBpbiBbICcnICcjJyAncmVtYXJrJ10pXG4gICAgICBsb2NhbGVzW2l0XSA9IGVsZW0taW5kZXggaXQsIGhlYWRlci1pdGVtc1xuXG4gIG1zZyBcIkdlbmVyYXRpbmcgLnltbCBmaWxlcyAuLi5cIlxuXG4gIGxvY2FsZXMgfD4ga2V5cyB8PiBlYWNoIChsYW5nKS0+XG4gICAgeWFtbC1saW5lcyA9IGxpbmVzXG4gICAgICAgICAgICAgIHw+IG1hcCAobGluZSktPlxuICAgICAgICAgICAgICAgICAgbGluZS1pdGVtcyA9IGxpbmUuc3BsaXQgJ1xcdCdcbiAgICAgICAgICAgICAgICAgICMgZmluZCAxc3Qgbm9uLWVtcHR5IGNvbHVtbiBvZiB0aGUgbGluZS5cbiAgICAgICAgICAgICAgICAgICMgd2hpY2ggaXMgdGhlIGtleS1pbmRleCBvZiB0aGUgY29ycmVzcG9uZGluZyB5YW1sIGxpbmVcbiAgICAgICAgICAgICAgICAgIGtleS1pbmRleCA9IGxpbmUtaXRlbXMgfD4gZmluZC1pbmRleCAtPiBpdCAhPSAnJ1xuICAgICAgICAgICAgICAgICAgdW5sZXNzIGlzLXR5cGUgJ1VuZGVmaW5lZCcsIGtleS1pbmRleFxuICAgICAgICAgICAgICAgICAgICBpbmRlbnQtbi1rZXkgPSBcIiN7JyAgJyAqIGtleS1pbmRleH0je2xpbmUtaXRlbXNba2V5LWluZGV4XX1cIlxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGxpbmUtaXRlbXNbbG9jYWxlc1tsYW5nXV0ucmVwbGFjZSgvXFxcIi9naSwnXFxcXFxcXCInKVxuICAgICAgICAgICAgICAgICAgICBsaW5lID0gXCIje2luZGVudC1uLWtleX06XCIgKyAoaWYgdmFsdWUgdGhlbiBcIiBcXFwiI3t2YWx1ZX1cXFwiXCIgZWxzZSAnJylcbiAgICAgICAgICAgICAgfD4gam9pbiAnXFxuJ1xuICAgIG91dHB1dC1maWxlID0gXCIje2Rlc3QtZm9sZGVyfS8je2xhbmd9LmkxOG4ueW1sXCJcbiAgICBtc2cgXCJcXHQgLT4gI3tvdXRwdXQtZmlsZX1cIlxuICAgIGZzIC53cml0ZUZpbGVTeW5jIG91dHB1dC1maWxlLCB5YW1sLWxpbmVzLCB7IGZsYWc6ICd3J31cblxuICAjIG1zZyBcIkdlbmVyYXRpbmcgLmpzb24gZmlsZXMgLi4uXCJcbiAgIyBwcmVmaXgta2V5cyA9IFtdXG4gICMgbG9jYWxlcyB8PiBrZXlzIHw+IGVhY2ggKGxhbmcpLT5cbiAgIyAgIGpzb24tbGluZXMgPSBsaW5lc1xuICAjICAgICAgICAgICAgIHw+IG1hcCAobGluZSktPlxuICAjICAgICAgICAgICAgICAgICBqc29uLWxpbmUgPSAnJ1xuICAjICAgICAgICAgICAgICAgICBsaW5lLWl0ZW1zID0gbGluZS5zcGxpdCAnXFx0J1xuICAjICAgICAgICAgICAgICAgICAjIGZpbmQgMXN0IG5vbi1lbXB0eSBjb2x1bW4gb2YgdGhlIGxpbmUuXG4gICMgICAgICAgICAgICAgICAgICMgd2hpY2ggaXMgdGhlIGtleS1pbmRleCBvZiB0aGUgY29ycmVzcG9uZGluZyB5YW1sIGxpbmVcbiAgIyAgICAgICAgICAgICAgICAga2V5LWluZGV4ID0gbGluZS1pdGVtcyB8PiBmaW5kLWluZGV4IC0+IGl0ICE9ICcnXG4gICMgICAgICAgICAgICAgICAgIGNvbXBhY3RlZC1pdGVtcyA9IGNvbXBhY3QobGluZS1pdGVtcylcbiAgIyAgICAgICAgICAgICAgICAgaWYga2V5LWluZGV4ID09IDAgIyB0b3AgbGV2ZWwga2V5XG4gICMgICAgICAgICAgICAgICAgICAgcHJlZml4LWtleXMgOj0gW10gIyByZXNldCBwcmVmaXgta2V5cyBhcnJheVxuICAjICAgICAgICAgICAgICAgICBpZiBjb21wYWN0ZWQtaXRlbXMubGVuZ3RoID09IDEgIyBsaW5lIHdpdGggb25seSBvbmUgcHJlZml4LWtleVxuICAjICAgICAgICAgICAgICAgICAgIHByZWZpeC1rZXlzW2tleS1pbmRleF0gPSBjb21wYWN0ZWQtaXRlbXNbMF0gIyByZXBsYWNlIHByZWZpeC1rZXlzXG4gICMgICAgICAgICAgICAgICAgIGlmIGNvbXBhY3RlZC1pdGVtcy5sZW5ndGggPiAxICMgbGluZSBjb250YWluaW5nIGJvdHRvbSBsZXZlbCBrZXkgYW5kIGxhbmcgdmFsdWVcbiAgIyAgICAgICAgICAgICAgICAgICB0aGlzLWtleSA9IGNvbXBhY3RlZC1pdGVtc1swXVxuICAjICAgICAgICAgICAgICAgICAgIHRoaXMtdmFsdWUgPSBsaW5lLWl0ZW1zW2xvY2FsZXNbbGFuZ11dLnJlcGxhY2UoL1xcXCIvZ2ksJ1xcXFxcXFwiJykgIyBlc2NhcGUgZG91YmxlIHF1b3RlICdcIidcbiAgIyAgICAgICAgICAgICAgICAgICBqc29uLWxpbmUgOj0gXCIgIFxcXCIjeyggY29uY2F0IFsgcHJlZml4LWtleXMsIFsgdGhpcy1rZXkgXSBdIHw+IGpvaW4gJy4nICl9XFxcIiA6IFxcXCIje3RoaXMtdmFsdWV9XFxcIlwiXG4gICMgICAgICAgICAgICAgICAgIHJldHVybiBqc29uLWxpbmVcbiAgIyAgICAgICAgICAgICB8PiByZWplY3QgLT4gaXQgPT0gJycgIyByZW1vdmUgZW1wdHkgbGluZXNcbiAgIyAgICAgICAgICAgICB8PiBqb2luICcsXFxuJ1xuICAjICAganNvbi1jb250ZW50ID0gXCJ7XFxuI3tqc29uLWxpbmVzfVxcbn1cIlxuICAjICAgb3V0cHV0LWZpbGUgPSBcIiN7ZGVzdC1mb2xkZXJ9LyN7bGFuZ30uanNvblwiXG4gICMgICBtc2cgXCJcXHQgLT4gI3tvdXRwdXQtZmlsZX1cIlxuICAjICAgZnMgLndyaXRlLWZpbGUtc3luYyBvdXRwdXQtZmlsZSwganNvbi1jb250ZW50LCB7IGZsYWc6ICd3J31cblxuZ2VuLWkxOG4teWFtbHMtZnJvbS11cmwgPSAodXJsLCBkZXN0LWZvbGRlciktPlxuICB1cmwgPSB1cmwgfHwgJydcbiAgZGVzdC1mb2xkZXIgPSBkZXN0LWZvbGRlciB8fCAnLidcbiAgIyBtYWtlIHN1cmUgZGVzdC1mb2xkZXIgZXhpc3RzXG4gIG1rZGlycCBkb1xuICAgIGRlc3QtZm9sZGVyXG4gICAgKGVyciktPlxuICAgICAgaWYgKGVycilcbiAgICAgICAgbXNnIFwiRXJyb3IgY3JlYXRpbmcgZGVzdGluYXRpb24gZm9sZGVyOiAje2Rlc3QtZm9sZGVyfVwiXG4gICAgICBlbHNlXG4gICAgICAgIG1zZyBcIkNyZWF0ZWQgZGVzdGluYXRpb24gZm9sZGVyOiAje2Rlc3QtZm9sZGVyfVwiXG4gICAgICAgIG1zZyBcIkdldHRpbmcgLnRzdiBmcm9tOiAje3VybH0uIFRhcmdldCBmb2xkZXI6ICN7ZGVzdC1mb2xkZXJ9XCJcbiAgICAgICAgZG93bmxvYWQgdXJsXG4gICAgICAgICAgLnRoZW4gKGRhdGEpLT5cbiAgICAgICAgICAgIHRzdi10by1pMThuLXlhbWxzKGRhdGEudG9TdHJpbmchLCBkZXN0LWZvbGRlcilcblxuYXJndiA9IHJlcXVpcmUoJ21pbmltaXN0JykocHJvY2Vzcy5hcmd2LnNsaWNlKDIpKVxubXNnIEpTT04uc3RyaW5naWZ5IGFyZ3ZcbmRlc3QtZm9sZGVyID0gYXJndi5wIHx8ICcuJ1xuZ2VuLWkxOG4teWFtbHMtZnJvbS11cmwgYXJndi5zLCBkZXN0LWZvbGRlclxuIl19
